{{ attach_library('myadmin/bootstrap_full') }}
<style>
.top_vente {
    font-size: 12px;
    list-style: none;
    text-align: left;
}
.top_vente li{
  width: 100px; /* Adjust width as needed */
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
}
</style>

<div class="container my-5 px-5 shadow">
  <h1>Dashboard</h1>
  <div class="row text-center mt-5">
    <div class="col">
      <div class="row border border-2 rounded">
        <h4>TOTAL DES VENTES</h4>
        <h5>{{price(total_vente_par_mois)}} AR</h5>
        <canvas id="pieChart"></canvas>
      </div>
      <div class="row border border-2 rounded mt-5">
        <h4>DATE PROCHE</h4>
        <h5>10 ARTICLES</h5>
      </div>
    </div>
    <div class="col-md-7">
      <div class="row">
        <div class="col-md-3 border border-2 rounded">
          <h4>TOTAL DES ACHATS</h4>
          <h5>1.200.000</h5>
        </div>
        <div class="col-md-3 border border-2 rounded">
          <h4>VALEUR DU STOCK</h4>
          <h5>{{price(valeur_stock)}} AR</h5>
        </div>
        <div class="col-md-3 border border-2 rounded">
          <h4>STOCK BAS</h4>
          <h5>{{bas_stock}} ARTICLES</h5>
        </div>
        <div class="col-md-3 border border-2 rounded">
          <h4>RUPTURE DE STOCK</h4>
          <h5>{{rupture_stock}} ARTICLES</h5>
        </div>
      </div>
      <div class="row mt-4">
        <canvas id="monthChart"></canvas>
      </div>
      <div class="row mt-4">
        <canvas id="barChart"></canvas>
      </div>
    </div>
    <div class="col">
      <div class="row border border-2 rounded">

        <h4>TOP VENTE CE MOIS</h4>       
        <ul class="top_vente">
        	{% for key,item in top_vente %}
            <li>{{item.num}} - {{item.name}} </li>
          {% endfor %}
        </ul>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js@4.0.1/dist/chart.umd.min.js"></script>
<script>
  var myPieChart = new Chart(document.getElementById("pieChart"), {
    type : 'pie',
    data : {
      labels : [ "Lion", "Horse", "Elephant", "Tiger",
        "Jaguar" ],
      datasets : [ {
        backgroundColor : [ "#51EAEA", "#FCDDB0",
          "#FF9D76", "#FB3569", "#82CD47" ],
        data : [ 418, 263, 434, 586, 332 ]
      } ]
    },
    options : {
      responsive: true,
      plugins: {
        legend: {
          position: 'bottom',
        },
        title: {
          display: true,
          text: 'Chart.js Pie Chart'
        }
      }
    }
  });

  const plugin = {
    id: 'customCanvasBackgroundColor',
    beforeDraw: (chart, args, options) => {
      const {ctx} = chart;
      ctx.save();
      ctx.globalCompositeOperation = 'destination-over';
      ctx.fillStyle = options.color || '#fff';
      ctx.fillRect(0, 0, chart.width, chart.height);
      ctx.restore();
    }
  };

  var myMonthChart = new Chart(document.getElementById("monthChart"), {
    type : 'line',
    data : {
      labels : [ 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31],
      datasets : [ {
        label: 'Vente en ariary',
        borderColor: '#fff',
        backgroundColor : '#fff',
        data : [ 10000, 7500, 15000, 20000, 17500, 25000, 22000, 30000, 17000, 15000, 10000, 20000, 17500, 25000, 27000, 10000, 7500, 15000, 20000, 17500, 25000, 22000, 30000, 17000, 15000, 10000, 20000, 17500, 25000, 27000, 30000],
      } ]
    },
    options: {
      responsive: true,
      plugins: {
        legend: {
          display: false,
        },
        title: {
          display: true,
          text: "Evolution des ventes du mois",
          size: 24,
          color: '#fff',
        },
        customCanvasBackgroundColor: {
          color: 'rgb(35,35,35)',
        }
      },
      scales:{
        y:{
          border: {
            display: false
          },
          grid: {
            color: '#fff'
          },
          ticks: {
            color: '#fff'
          }
        },
        x:{
          ticks: {
            color: '#fff'
          }
        }
      },
    },
    plugins: [plugin],
  });

  var myBarChart = new Chart(document.getElementById("barChart"), {
    type : 'bar',
    data : {
      labels : ['JAN','FEV','MAR','AVR','MAI','JUN','JUI','AOU','SEP','OCT','NOV','DEC'],
      datasets : [
        {
          label: 'Vente',
          borderColor: 'rgb(74,71,71)',
          backgroundColor : 'rgba(10,27,184,0.7)',
          data : [ 10000, 7500, 15000, 20000, 17500, 25000, 22000, 30000, 17000, 15000, 10000, 20000]
        },
        {
          label: 'Achat',
          borderColor: 'rgb(74,71,71)',
          backgroundColor : 'rgba(238,118,57,0.7)',
          data : [ 17500, 25000, 27000, 10000, 7500, 15000, 20000, 17500, 25000, 22000, 30000, 12000]
        }
      ]
    },
    options: {
      responsive: true,
      plugins: {
        legend: {
          position: 'bottom',
        },
        title: {
          display: true,
          text: "Evolution des ventes et achats annuelles",
          color: '#fff',
          size: 24
        },
        customCanvasBackgroundColor: {
          color: 'rgb(35,35,35)',
        }
      },
      scales:{
        y:{
          border: {
            display: false
          },
          grid: {
            color: '#fff'
          },
          ticks: {
            color: '#fff'
          }
        },
        x:{
          ticks: {
            color: '#fff'
          }
        }
      },
    },
    plugins: [plugin],
  });
</script>
